# Training-Free GRPO ä½¿ç”¨æŒ‡å—

## ğŸ“– ç›®å½•

1. [ç³»ç»Ÿæ¦‚è¿°](#ç³»ç»Ÿæ¦‚è¿°)
2. [æ ¸å¿ƒæ¦‚å¿µ](#æ ¸å¿ƒæ¦‚å¿µ)
3. [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
4. [è¯¦ç»†é…ç½®](#è¯¦ç»†é…ç½®)
5. [è®­ç»ƒæµç¨‹](#è®­ç»ƒæµç¨‹)
6. [è¯„ä¼°ä½¿ç”¨](#è¯„ä¼°ä½¿ç”¨)
7. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## ç³»ç»Ÿæ¦‚è¿°

### ä»€ä¹ˆæ˜¯ Training-Free GRPOï¼Ÿ

Training-Free GRPOï¼ˆè®­ç»ƒè‡ªç”±ç»„ç›¸å¯¹ç­–ç•¥ä¼˜åŒ–ï¼‰æ˜¯ä¸€ç§**æ— éœ€æ›´æ–°æ¨¡å‹å‚æ•°**çš„å¼ºåŒ–å­¦ä¹ æ–¹æ³•ï¼Œé€šè¿‡ç»´æŠ¤å¤–éƒ¨**ç»éªŒåº“**æ¥ä¼˜åŒ–LLMæ™ºèƒ½ä½“çš„æ€§èƒ½ã€‚

### æ ¸å¿ƒä¼˜åŠ¿

| ç‰¹æ€§ | ä¼ ç»ŸRL | Training-Free GRPO |
|------|--------|-------------------|
| **å‚æ•°æ›´æ–°** | âœ— éœ€è¦ (~10,000 GPUå°æ—¶) | âœ“ ä¸éœ€è¦ (0 GPUå°æ—¶) |
| **è®­ç»ƒæ•°æ®** | âœ— éœ€è¦æ•°åƒæ ·æœ¬ | âœ“ 50-100ä¸ªæ ·æœ¬å³å¯ |
| **è®­ç»ƒæˆæœ¬** | âœ— ~$10,000 | âœ“ ~$20-30 |
| **è·¨åŸŸæ³›åŒ–** | âœ— å·®ï¼ˆéœ€è¦å¤šä¸ªä¸“ç”¨æ¨¡å‹ï¼‰ | âœ“ ä¼˜ç§€ï¼ˆå…±äº«ç»éªŒåº“ï¼‰ |
| **è¿‡æ‹Ÿåˆé£é™©** | âœ— é«˜ | âœ“ ä½ |

### åœ¨ä½ çš„æ¡†æ¶ä¸­çš„åº”ç”¨

```
ä½ çš„å¤šæ™ºèƒ½ä½“å› æœæ¨ç†æ¡†æ¶:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3ä¸ªç”Ÿæˆå™¨ (Generators)              â”‚
â”‚  â”œâ”€ Generator 1: ä¸“æ³¨å‡ ä½•æ¨ç†        â”‚
â”‚  â”œâ”€ Generator 2: ä¸“æ³¨ä»£æ•°æ¨ç†        â”‚
â”‚  â””â”€ Generator 3: ä¸“æ³¨ç‰©ç†æ¨ç†        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1ä¸ªæ‰¹åˆ¤è€… (Critic)                  â”‚
â”‚  â””â”€ èåˆã€ä¼˜åŒ–ã€éªŒè¯                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ·»åŠ  Training-Free GRPO å:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç»éªŒåº“ (Experience Libraries)       â”‚
â”‚  â”œâ”€ å…±äº«ç»éªŒ (Shared)               â”‚
â”‚  â”œâ”€ Generator 1 ä¸“å±ç»éªŒ            â”‚
â”‚  â”œâ”€ Generator 2 ä¸“å±ç»éªŒ            â”‚
â”‚  â”œâ”€ Generator 3 ä¸“å±ç»éªŒ            â”‚
â”‚  â””â”€ Critic ä¸“å±ç»éªŒ                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“ æ³¨å…¥ç»éªŒåˆ°æç¤º
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ™ºèƒ½ä½“ç”Ÿæˆç­”æ¡ˆæ—¶è‡ªåŠ¨åº”ç”¨ç»éªŒ        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æ ¸å¿ƒæ¦‚å¿µ

### 1. ç»éªŒåº“ (Experience Library)

**ç»éªŒ** = LLMä»æˆåŠŸ/å¤±è´¥æ¡ˆä¾‹ä¸­å­¦åˆ°çš„å¯å¤ç”¨çŸ¥è¯†

ç¤ºä¾‹ç»éªŒï¼š
```
G1-001: [causal_graph] æ„é€ å› æœå›¾æ—¶ï¼Œç¡®ä¿æ‰€æœ‰å› æœé“¾æ¥ä¸­çš„å˜é‡éƒ½å­˜åœ¨äºknownså­—å…¸ä¸­
G2-003: [validation] åœ¨ç”Ÿæˆè®¡ç®—è®¡åˆ’å‰ï¼Œå…ˆéªŒè¯ç›®æ ‡å˜é‡æ˜¯å¦æ­£ç¡®è¯†åˆ«
C-001: [fusion_strategy] èåˆææ¡ˆæ—¶ï¼Œä¼˜å…ˆé€‰æ‹©å› æœé“¾æ¥æ›´å®Œæ•´ä¸”å˜é‡å®šä¹‰ä¸€è‡´çš„æ–¹æ¡ˆ
S-005: [general] ç‰©ç†é—®é¢˜ä¼˜å…ˆè€ƒè™‘èƒ½é‡å®ˆæ’æ–¹æ³•ç®€åŒ–è®¡ç®—
```

### 2. Group Rolloutsï¼ˆç»„å¯¹æ¯”ï¼‰

å¯¹æ¯ä¸ªé—®é¢˜ç”Ÿæˆ**å¤šä¸ªç­”æ¡ˆ**ï¼Œå¯¹æ¯”æˆåŠŸå’Œå¤±è´¥çš„æ¡ˆä¾‹ï¼š

```python
é—®é¢˜: "å°çƒä»20ç±³é«˜åº¦è½ä¸‹ï¼Œæ±‚è½åœ°æ—¶é—´ï¼Ÿ"

ç”Ÿæˆ3ä¸ªç­”æ¡ˆï¼ˆä½¿ç”¨3ä¸ªgeneratorsï¼‰:
  Rollout 1 (Generator 1): ç­”æ¡ˆ = 2ç§’ âœ“ æ­£ç¡®
  Rollout 2 (Generator 2): ç­”æ¡ˆ = 4ç§’ âœ— é”™è¯¯  
  Rollout 3 (Generator 3): ç­”æ¡ˆ = 2ç§’ âœ“ æ­£ç¡®

æå–ç»éªŒ:
  "è‡ªç”±è½ä½“é—®é¢˜å…ˆåˆ¤æ–­åˆé€Ÿåº¦æ˜¯å¦ä¸º0ï¼Œç„¶åä½¿ç”¨h=Â½gtÂ²å…¬å¼"
```

### 3. è¯­ä¹‰ä¼˜åŠ¿ (Semantic Advantage)

ä¼ ç»ŸGRPOä½¿ç”¨**æ•°å€¼ä¼˜åŠ¿**ï¼š`advantage_i = (reward_i - mean) / std`

Training-Free GRPOä½¿ç”¨**è¯­ä¹‰ä¼˜åŠ¿**ï¼ˆè‡ªç„¶è¯­è¨€ç»éªŒï¼‰ï¼š
```
"åœ¨å‡ ä½•é—®é¢˜ä¸­ï¼ŒéªŒè¯è§£æ˜¯å¦åœ¨æœ‰ç•ŒåŒºåŸŸå†…ï¼Œé¿å…å¤–å»¶è§£"
```

### 4. å¤šEpochè¿­ä»£å­¦ä¹ 

```
Epoch 1: åŸºç¡€ç»éªŒå­¦ä¹ 
  â†’ 100ä¸ªé—®é¢˜ â†’ æå–20æ¡ç»éªŒ

Epoch 2: ç»éªŒç²¾ç‚¼
  â†’ ä½¿ç”¨Epoch 1çš„ç»éªŒ â†’ ä¿®æ”¹5æ¡ï¼Œæ–°å¢8æ¡

Epoch 3: ç»éªŒä¼˜åŒ–
  â†’ ä½¿ç”¨Epoch 2çš„ç»éªŒ â†’ åˆ é™¤3æ¡ä½è´¨é‡ç»éªŒï¼Œæ–°å¢5æ¡
```

---

## å¿«é€Ÿå¼€å§‹

### æ­¥éª¤1ï¼šå‡†å¤‡è®­ç»ƒæ•°æ®

è®­ç»ƒæ•°æ®å·²ç»å‡†å¤‡å¥½ï¼š
- âœ… AIME 2024ï¼š`dataset/AIME_2024/aime_2024_problems.json`
- âœ… AIME 2025ï¼š`dataset/AIME2025/aime2025-I.jsonl` å’Œ `aime2025-II.jsonl`
- âš ï¸ ç‰©ç†é—®é¢˜ï¼šéœ€è¦æ‚¨åˆ›å»º `dataset/physics_problems.json`

**åˆ›å»ºç‰©ç†é—®é¢˜æ–‡ä»¶**ï¼š

å¤åˆ¶ç¤ºä¾‹æ–‡ä»¶å¹¶å¡«å…¥æ‚¨çš„30é“ç‰©ç†é¢˜ï¼š
```bash
cp dataset/physics_problems_example.json dataset/physics_problems.json
```

ç„¶åç¼–è¾‘ `physics_problems.json`ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š
```json
[
  {
    "problem": "ä¸€ä¸ªè´¨é‡ä¸º5kgçš„ç‰©ä½“åœ¨å…‰æ»‘å¹³é¢ä¸Šå—åˆ°20Nçš„åŠ›ï¼Œæ±‚åŠ é€Ÿåº¦ã€‚",
    "answer": "4",
    "subject": "physics",
    "topic": "newton_laws"
  },
  {
    "problem": "å°çƒä»é«˜åº¦hè‡ªç”±è½ä¸‹ï¼Œè½åœ°æ—¶é—´ä¸º2ç§’ï¼Œæ±‚hã€‚(g=10m/sÂ²)",
    "answer": "20",
    "subject": "physics",
    "topic": "free_fall"
  }
  // ... æ·»åŠ æ›´å¤šé—®é¢˜
]
```

### æ­¥éª¤2ï¼šå¼€å§‹è®­ç»ƒ

**æœ€ç®€å•çš„æ–¹å¼**ï¼š
```bash
python train_with_grpo.py
```

è¿™å°†ï¼š
- ä½¿ç”¨ AIME2024 + AIME2025 + Physics æ•°æ®é›†
- è®­ç»ƒ 3 ä¸ª epochs
- ä½¿ç”¨ 3 ä¸ª generatorsï¼ˆå¯¹åº”ä½ çš„3ä¸ªæ™ºèƒ½ä½“ï¼‰
- ä¿å­˜ç»éªŒåˆ° `data/grpo_experiences/`

**è‡ªå®šä¹‰è®­ç»ƒ**ï¼š
```bash
# åªç”¨AIME2024è®­ç»ƒ
python train_with_grpo.py --datasets aime2024

# 5ä¸ªepochsï¼Œé™åˆ¶50ä¸ªé—®é¢˜
python train_with_grpo.py --epochs 5 --max-problems 50

# ä½¿ç”¨ç°æœ‰ç»éªŒç»§ç»­è®­ç»ƒ
python train_with_grpo.py --use-existing-experiences
```

### æ­¥éª¤3ï¼šæŸ¥çœ‹å­¦åˆ°çš„ç»éªŒ

è®­ç»ƒå®Œæˆåï¼ŒæŸ¥çœ‹ç»éªŒåº“ï¼š
```bash
# å…±äº«ç»éªŒ
cat data/grpo_experiences/shared_experiences.json

# Generator 1 çš„ç»éªŒ
cat data/grpo_experiences/generator_1_experiences.json

# Critic çš„ç»éªŒ
cat data/grpo_experiences/critic_experiences.json
```

### æ­¥éª¤4ï¼šä½¿ç”¨è®­ç»ƒå¥½çš„ç³»ç»Ÿ

ä¿®æ”¹ `main.py` æˆ– `evaluate_framework.py`ï¼Œæ·»åŠ ç»éªŒç®¡ç†å™¨ï¼š

```python
from engine import GRPOExperienceManager

# åˆå§‹åŒ–ç»éªŒç®¡ç†å™¨
experience_manager = GRPOExperienceManager(
    experience_dir="data/grpo_experiences"
)

# åˆå§‹åŒ–å¼•æ“
engine = CausalReasoningEngine(
    use_multi_agent=True,
    # ... å…¶ä»–å‚æ•°
)

# å°†ç»éªŒç®¡ç†å™¨æ³¨å…¥åˆ°scaffolder
if hasattr(engine.scaffolder, 'experience_manager'):
    engine.scaffolder.experience_manager = experience_manager
```

---

## è¯¦ç»†é…ç½®

### è®­ç»ƒå‚æ•°è¯´æ˜

| å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜ |
|------|--------|------|
| `--datasets` | `aime2024 aime2025 physics` | è®­ç»ƒæ•°æ®é›† |
| `--epochs` | `3` | è®­ç»ƒè½®æ•°ï¼ˆè®ºæ–‡å»ºè®®3ï¼‰ |
| `--group-size` | `3` | æ¯ä¸ªé—®é¢˜ç”Ÿæˆçš„ç­”æ¡ˆæ•°é‡ |
| `--max-problems` | `None` | é™åˆ¶é—®é¢˜æ•°é‡ï¼ˆæµ‹è¯•ç”¨ï¼‰ |
| `--experience-dir` | `data/grpo_experiences` | ç»éªŒåº“ä¿å­˜ç›®å½• |
| `--use-existing-experiences` | `False` | æ˜¯å¦ç»§ç»­è®­ç»ƒç°æœ‰ç»éªŒ |

### ç»éªŒåº“ç»“æ„

```
data/grpo_experiences/
â”œâ”€â”€ shared_experiences.json          # æ‰€æœ‰æ™ºèƒ½ä½“å…±äº«çš„ç»éªŒ
â”œâ”€â”€ generator_1_experiences.json     # Generator 1 ä¸“å±ç»éªŒ
â”œâ”€â”€ generator_2_experiences.json     # Generator 2 ä¸“å±ç»éªŒ
â”œâ”€â”€ generator_3_experiences.json     # Generator 3 ä¸“å±ç»éªŒ
â””â”€â”€ critic_experiences.json          # Critic ä¸“å±ç»éªŒ

checkpoints/grpo/                    # è®­ç»ƒæ£€æŸ¥ç‚¹
â”œâ”€â”€ epoch_1.json
â”œâ”€â”€ epoch_2.json
â””â”€â”€ epoch_3.json

data/grpo_experiences_final.json     # æœ€ç»ˆå¯¼å‡ºçš„å®Œæ•´ç»éªŒåº“
```

### å•æ¡ç»éªŒçš„æ ¼å¼

```json
{
  "id": "G1-001",
  "content": "æ„é€ å› æœå›¾æ—¶ï¼Œç¡®ä¿æ‰€æœ‰å˜é‡éƒ½åœ¨knownsä¸­å®šä¹‰",
  "category": "causal_graph_validation",
  "success_count": 15,
  "usage_count": 20,
  "created_at": "2025-01-15T10:30:00",
  "source_problem": "A ball is dropped from..."
}
```

---

## è®­ç»ƒæµç¨‹

### å®Œæ•´è®­ç»ƒæµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. åŠ è½½è®­ç»ƒé—®é¢˜                       â”‚
â”‚    - AIME2024 (30é¢˜)                 â”‚
â”‚    - AIME2025 (15é¢˜)                 â”‚
â”‚    - Physics (30é¢˜)                  â”‚
â”‚    Total: 75é¢˜                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. åˆå§‹åŒ–ç»éªŒç®¡ç†å™¨                   â”‚
â”‚    - åˆ›å»º5ä¸ªç»éªŒåº“                    â”‚
â”‚    - åŠ è½½ç°æœ‰ç»éªŒï¼ˆå¦‚æœæœ‰ï¼‰            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. Epoch 1: åˆå§‹å­¦ä¹                  â”‚
â”‚    For each problem:                 â”‚
â”‚      a) ç”Ÿæˆ3ä¸ªrollouts              â”‚
â”‚      b) è¯„ä¼°æ­£ç¡®æ€§                   â”‚
â”‚      c) æå–è¯­ä¹‰ä¼˜åŠ¿                 â”‚
â”‚      d) æ›´æ–°ç»éªŒåº“ (Add/Modify)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. Epoch 2: ç»éªŒç²¾ç‚¼                 â”‚
â”‚    ä½¿ç”¨Epoch 1å­¦åˆ°çš„ç»éªŒ:             â”‚
â”‚      - æ™ºèƒ½ä½“åº”ç”¨ç»éªŒç”Ÿæˆæ›´å¥½çš„ç­”æ¡ˆ   â”‚
â”‚      - ä¿®æ”¹/ä¼˜åŒ–ç°æœ‰ç»éªŒ              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. Epoch 3: ç»éªŒä¼˜åŒ–                 â”‚
â”‚    ä½¿ç”¨Epoch 2ä¼˜åŒ–çš„ç»éªŒ:             â”‚
â”‚      - åˆ é™¤ä½è´¨é‡ç»éªŒ                 â”‚
â”‚      - æ·»åŠ æ–°å‘ç°çš„æ¨¡å¼               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. ä¿å­˜æœ€ç»ˆç»éªŒåº“                     â”‚
â”‚    - å¯¼å‡ºéƒ¨ç½²ç”¨ç»éªŒ                   â”‚
â”‚    - ç”Ÿæˆè®­ç»ƒæŠ¥å‘Š                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å•ä¸ªé—®é¢˜çš„å¤„ç†æµç¨‹

```python
é—®é¢˜: "å°çƒä»20ç±³é«˜åº¦è½ä¸‹ï¼Œæ±‚æ—¶é—´ï¼Ÿ"

Step 1: ç”Ÿæˆ Group Rollouts
  Generator 1 â†’ å› æœå›¾1 â†’ ç­”æ¡ˆ: 2ç§’ âœ“
  Generator 2 â†’ å› æœå›¾2 â†’ ç­”æ¡ˆ: 4ç§’ âœ—
  Generator 3 â†’ å› æœå›¾3 â†’ ç­”æ¡ˆ: 2ç§’ âœ“

Step 2: è¯„ä¼° Rewards
  Rollout 1: Correct (reward = True)
  Rollout 2: Incorrect (reward = False)
  Rollout 3: Correct (reward = True)

Step 3: æ€»ç»“ Trajectories
  LLMåˆ†ææ¯ä¸ªrollout:
    - Rollout 1: "æ­£ç¡®åº”ç”¨äº†è‡ªç”±è½ä½“å…¬å¼"
    - Rollout 2: "é”™è¯¯åœ°ä½¿ç”¨äº†åŒ€é€Ÿè¿åŠ¨å…¬å¼"
    - Rollout 3: "æ­£ç¡®è¯†åˆ«äº†åˆé€Ÿåº¦ä¸º0"

Step 4: æå–è¯­ä¹‰ä¼˜åŠ¿
  LLMå¯¹æ¯”æˆåŠŸ/å¤±è´¥æ¡ˆä¾‹ï¼Œæå–ç»éªŒ:
    "è‡ªç”±è½ä½“é—®é¢˜é¦–å…ˆåˆ¤æ–­åˆé€Ÿåº¦æ˜¯å¦ä¸º0"
    "ä½¿ç”¨h=Â½gtÂ²è€Œä¸æ˜¯h=vt"

Step 5: æ›´æ–°ç»éªŒåº“
  Operation 1: Add
    - æ·»åŠ åˆ° shared_experiences
    - ID: S-023
    - Content: "è‡ªç”±è½ä½“é—®é¢˜é¦–å…ˆåˆ¤æ–­vâ‚€=0"
  
  Operation 2: Modify
    - ä¿®æ”¹ Generator 2 çš„ç»éªŒ
    - åŸ: "ç‰©ç†é—®é¢˜ä½¿ç”¨è¿åŠ¨å­¦å…¬å¼"
    - æ–°: "ç‰©ç†é—®é¢˜å…ˆåˆ¤æ–­è¿åŠ¨ç±»å‹ï¼Œå†é€‰æ‹©å…¬å¼"
```

---

## è¯„ä¼°ä½¿ç”¨

### æ–¹æ³•1ï¼šåœ¨ main.py ä¸­ä½¿ç”¨

```python
from main import CausalReasoningEngine
from engine import GRPOExperienceManager

# åŠ è½½è®­ç»ƒå¥½çš„ç»éªŒ
exp_manager = GRPOExperienceManager(
    experience_dir="data/grpo_experiences"
)

# åˆå§‹åŒ–å¼•æ“
engine = CausalReasoningEngine(
    use_multi_agent=True,
    num_generators=3
)

# æ³¨å…¥ç»éªŒ
engine.scaffolder.experience_manager = exp_manager

# è§£å†³é—®é¢˜ï¼ˆè‡ªåŠ¨ä½¿ç”¨ç»éªŒï¼‰
result = engine.solve_problem({
    'problem': 'A ball is dropped from 10m. Find the time.',
    'answer': '1.41'
})
```

### æ–¹æ³•2ï¼šåœ¨ evaluate_framework.py ä¸­æ‰¹é‡è¯„ä¼°

ä¿®æ”¹ `evaluate_framework.py`ï¼Œæ·»åŠ ï¼š

```python
# åœ¨ __init__ ä¸­
self.use_grpo = use_grpo_experiences
if self.use_grpo:
    from engine import GRPOExperienceManager
    self.exp_manager = GRPOExperienceManager(
        experience_dir="data/grpo_experiences"
    )
    # æ³¨å…¥åˆ° engine
    self.engine.scaffolder.experience_manager = self.exp_manager

# ç„¶åæ­£å¸¸è¿è¡Œè¯„ä¼°
python evaluate_framework.py --dataset aime2024 --use-grpo-experiences
```

### å¯¹æ¯”å®éªŒï¼šæœ‰/æ— ç»éªŒ

```bash
# æ— ç»éªŒåŸºçº¿
python evaluate_framework.py --dataset aime2024 --output baseline.json

# ä½¿ç”¨ç»éªŒ
python evaluate_framework.py --dataset aime2024 --use-grpo-experiences --output with_grpo.json

# å¯¹æ¯”ç»“æœ
python analyze_results.py baseline.json with_grpo.json
```

é¢„æœŸæå‡ï¼š
- **å‡†ç¡®ç‡**: +5% ~ +10%
- **æ¨ç†è´¨é‡**: å› æœå›¾æ›´å®Œæ•´ã€ä¸€è‡´
- **æ•ˆç‡**: å‡å°‘é‡è¯•æ¬¡æ•°

---

## å¸¸è§é—®é¢˜

### Q1: è®­ç»ƒéœ€è¦å¤šé•¿æ—¶é—´ï¼Ÿ

**A:** å–å†³äºé—®é¢˜æ•°é‡å’ŒLLMé€Ÿåº¦ï¼š
- 75ä¸ªé—®é¢˜ï¼Œ3ä¸ªepochsï¼šçº¦ 2-3 å°æ—¶
- 100ä¸ªé—®é¢˜ï¼Œ3ä¸ªepochsï¼šçº¦ 3-4 å°æ—¶
- 50ä¸ªé—®é¢˜ï¼Œ3ä¸ªepochsï¼šçº¦ 1-2 å°æ—¶

### Q2: è®­ç»ƒæˆæœ¬æ˜¯å¤šå°‘ï¼Ÿ

**A:** ä½¿ç”¨ DeepSeek APIï¼š
- 75ä¸ªé—®é¢˜ï¼Œ3ä¸ªepochsï¼šçº¦ $20-30
- æ¯”ä¼ ç»ŸRLè®­ç»ƒï¼ˆ~$10,000ï¼‰ä¾¿å®œ 300+ å€

### Q3: å¯ä»¥ç”¨æ›´å°‘çš„æ•°æ®è®­ç»ƒå—ï¼Ÿ

**A:** å¯ä»¥ï¼è®ºæ–‡æ˜¾ç¤ºï¼š
- æœ€å°‘ï¼š30-50ä¸ªé—®é¢˜å³å¯è§æ•ˆ
- æ¨èï¼š75-100ä¸ªé—®é¢˜æ•ˆæœæ›´å¥½
- æ›´å¤šï¼š>150ä¸ªé—®é¢˜æ”¶ç›Šé€’å‡

è¯•è¯•ï¼š
```bash
python train_with_grpo.py --max-problems 30 --epochs 3
```

### Q4: ç»éªŒåº“ä¼šä¸ä¼šå¤ªå¤§ï¼Ÿ

**A:** ä¸ä¼šï¼Œéå¸¸å°ï¼š
- æ¯æ¡ç»éªŒï¼šâ‰¤32ä¸ªè¯
- å…¸å‹ç»éªŒåº“ï¼š50-100æ¡ç»éªŒ
- æ€»å¤§å°ï¼š< 50KB

### Q5: å¦‚ä½•åˆ¤æ–­ç»éªŒè´¨é‡ï¼Ÿ

æŸ¥çœ‹ `success_rate`ï¼ˆæˆåŠŸç‡ï¼‰ï¼š

```python
from engine import GRPOExperienceManager

manager = GRPOExperienceManager()
stats = manager.get_statistics()

# æŸ¥çœ‹æ¯ä¸ªæ™ºèƒ½ä½“çš„æˆåŠŸç‡
for agent_type in ['generator_1', 'generator_2', 'generator_3', 'critic']:
    rate = stats.get(f'{agent_type}_success_rate', 0)
    print(f"{agent_type}: {rate:.1%}")
```

é«˜è´¨é‡ç»éªŒï¼šsuccess_rate > 70%

### Q6: å¯ä»¥åªè®­ç»ƒç‰¹å®šæ™ºèƒ½ä½“å—ï¼Ÿ

**A:** å¯ä»¥ï¼ä¿®æ”¹ `grpo_trainer.py` ä¸­çš„é€»è¾‘ï¼š

```python
# åªæ›´æ–° generator_1 çš„ç»éªŒ
self._apply_experience_operations(operations, 'generator_1')

# åªæ›´æ–° critic çš„ç»éªŒ
self._apply_experience_operations(operations, 'critic')
```

### Q7: å¦‚ä½•æ·»åŠ æ–°çš„ç‰©ç†é—®é¢˜ï¼Ÿ

**A:** ç¼–è¾‘ `dataset/physics_problems.json`ï¼š

```json
{
  "problem": "ä½ çš„ç‰©ç†é—®é¢˜",
  "answer": "ç­”æ¡ˆ",
  "subject": "physics",
  "topic": "è‡ªç”±è½ä½“|åŠ›å­¦|èƒ½é‡|ç¢°æ’ç­‰"
}
```

ç„¶åé‡æ–°è®­ç»ƒå³å¯ã€‚

### Q8: å¯ä»¥ä»æ£€æŸ¥ç‚¹æ¢å¤è®­ç»ƒå—ï¼Ÿ

**A:** å¯ä»¥ï¼

```bash
# ä» epoch 2 çš„æ£€æŸ¥ç‚¹æ¢å¤
cp checkpoints/grpo/epoch_2.json data/grpo_experiences_final.json

# ç»§ç»­è®­ç»ƒ
python train_with_grpo.py --use-existing-experiences --epochs 2
```

### Q9: å¦‚ä½•è°ƒè¯•è®­ç»ƒè¿‡ç¨‹ï¼Ÿ

**A:** æŸ¥çœ‹è¯¦ç»†æ—¥å¿—ï¼š

```python
# åœ¨ train_with_grpo.py ä¸­
trainer = TrainingFreeGRPOTrainer(
    verbose=True  # æ‰“å¼€è¯¦ç»†æ—¥å¿—
)

# è®­ç»ƒåæŸ¥çœ‹æ—¥å¿—
manager.print_summary()  # æ‰“å°ç»Ÿè®¡ä¿¡æ¯
```

### Q10: è®­ç»ƒåæ€§èƒ½æ²¡æœ‰æå‡æ€ä¹ˆåŠï¼Ÿ

**å¯èƒ½åŸå› å’Œè§£å†³æ–¹æ¡ˆ**ï¼š

1. **è®­ç»ƒæ•°æ®å¤ªå°‘**
   - è§£å†³ï¼šå¢åŠ åˆ°75-100ä¸ªé—®é¢˜

2. **Epochså¤ªå°‘**
   - è§£å†³ï¼šä½¿ç”¨3-5ä¸ªepochs

3. **ç»éªŒè´¨é‡ä½**
   - è§£å†³ï¼šæ£€æŸ¥ `success_rate`ï¼Œåˆ é™¤ä½è´¨é‡ç»éªŒ

4. **LLMæ¸©åº¦å¤ªé«˜**
   - è§£å†³ï¼šé™ä½ `generator_temperature` åˆ° 0.3

5. **ç»éªŒæ²¡æœ‰æ³¨å…¥**
   - è§£å†³ï¼šç¡®è®¤ `experience_manager` æ­£ç¡®æ³¨å…¥åˆ° scaffolder

---

## é«˜çº§ç”¨æ³•

### 1. è‡ªå®šä¹‰ç»éªŒæå–Prompt

ä¿®æ”¹ `engine/grpo_trainer.py` ä¸­çš„ `advantage_prompt`ï¼š

```python
self.advantage_prompt = """
ä½ çš„è‡ªå®šä¹‰æç¤º...
å…³æ³¨ç‚¹ï¼š
1. å› æœå›¾æ„é€ é”™è¯¯
2. å˜é‡å®šä¹‰ä¸ä¸€è‡´
3. è®¡ç®—è®¡åˆ’é€»è¾‘é—®é¢˜
...
"""
```

### 2. ä¸ºä¸åŒä¸»é¢˜è®­ç»ƒä¸“é—¨ç»éªŒ

```bash
# åªç”¨å‡ ä½•é—®é¢˜è®­ç»ƒ
python train_with_grpo.py --datasets geometry_problems

# åªç”¨ä»£æ•°é—®é¢˜è®­ç»ƒ
python train_with_grpo.py --datasets algebra_problems
```

### 3. A/Bæµ‹è¯•ä¸åŒé…ç½®

```bash
# é…ç½®A: 3 epochs, group_size=3
python train_with_grpo.py --epochs 3 --group-size 3 --experience-dir data/exp_A

# é…ç½®B: 5 epochs, group_size=5
python train_with_grpo.py --epochs 5 --group-size 5 --experience-dir data/exp_B

# å¯¹æ¯”æ€§èƒ½
python evaluate_framework.py --experience-dir data/exp_A --output results_A.json
python evaluate_framework.py --experience-dir data/exp_B --output results_B.json
```

### 4. ç»éªŒè¿ç§»å­¦ä¹ 

```python
# ä»æ•°å­¦ç»éªŒè¿ç§»åˆ°ç‰©ç†
math_manager = GRPOExperienceManager("data/math_experiences")
physics_manager = GRPOExperienceManager("data/physics_experiences")

# å¤åˆ¶å…±äº«ç»éªŒ
physics_manager.experiences['shared'] = math_manager.experiences['shared']
physics_manager.save_all()
```

---

## æ€»ç»“

### å…³é”®è¦ç‚¹

âœ… **æ— éœ€å‚æ•°æ›´æ–°**ï¼šæ¨¡å‹å‚æ•°æ°¸è¿œå†»ç»“  
âœ… **æ•°æ®é«˜æ•ˆ**ï¼š50-100ä¸ªé—®é¢˜å³å¯  
âœ… **æˆæœ¬æä½**ï¼š~$20-30 vs ~$10,000  
âœ… **æ³›åŒ–èƒ½åŠ›å¼º**ï¼šè·¨åŸŸä½¿ç”¨åŒä¸€æ¨¡å‹  
âœ… **æ˜“äºéƒ¨ç½²**ï¼šåªéœ€åŠ è½½ç»éªŒåº“JSON  

### æ¨èå·¥ä½œæµ

```
1. å‡†å¤‡æ•°æ®ï¼ˆ75ä¸ªé—®é¢˜ï¼‰
   â†“
2. è®­ç»ƒï¼ˆ3 epochsï¼Œ2-3å°æ—¶ï¼‰
   â†“
3. æŸ¥çœ‹ç»éªŒåº“
   â†“
4. è¯„ä¼°æ€§èƒ½æå‡
   â†“
5. ç»§ç»­è¿­ä»£ä¼˜åŒ–
```

### åç»­ä¼˜åŒ–æ–¹å‘

1. **å¢åŠ è®­ç»ƒæ•°æ®**ï¼š100-150ä¸ªé—®é¢˜
2. **è°ƒæ•´Prompt**ï¼šä¼˜åŒ–ç»éªŒæå–çš„è´¨é‡
3. **ä¸“é¢˜åŒ–ç»éªŒ**ï¼šä¸ºä¸åŒé¢˜å‹è®­ç»ƒä¸“é—¨ç»éªŒ
4. **ç»éªŒå»é‡**ï¼šåˆå¹¶ç›¸ä¼¼ç»éªŒï¼Œæé«˜å¯†åº¦
5. **åŠ¨æ€è°ƒæ•´**ï¼šæ ¹æ®ä½¿ç”¨åé¦ˆæŒç»­æ›´æ–°ç»éªŒ

---

## å‚è€ƒèµ„æ–™

- è®ºæ–‡åŸæ–‡ï¼š`2510.08191v1 (1).pdf-7157a41b-b45d-471a-82e1-ad5381c0f00c/full.md`
- ä»£ç å®ç°ï¼š
  - `engine/grpo_experience_manager.py`
  - `engine/grpo_trainer.py`
  - `engine/multi_agent_scaffolder.py`
- è®­ç»ƒè„šæœ¬ï¼š`train_with_grpo.py`

---

**ç¥è®­ç»ƒé¡ºåˆ©ï¼ğŸ‰**

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ä»£ç æ³¨é‡Šæˆ–è”ç³»å¼€å‘è€…ã€‚




